


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html id="htmlId">
<head>
  <title>Coverage Report :: SeiGenerator</title>
  <style type="text/css">
    @import "../../.css/coverage.css";
  </style>
</head>

<body>
<div class="header"></div>

<div class="content">
<div class="breadCrumbs">
    [ <a href="../../index.html">all classes</a> ]
    [ <a href="../index.html">com.sun.tools.internal.ws.processor.generator</a> ]
</div>

<h1>Coverage Summary for Class: SeiGenerator (com.sun.tools.internal.ws.processor.generator)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">SeiGenerator</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 16)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 224)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<div class="sourceCode"><i>1</i>&nbsp;//
<i>2</i>&nbsp;// Source code recreated from a .class file by IntelliJ IDEA
<i>3</i>&nbsp;// (powered by Fernflower decompiler)
<i>4</i>&nbsp;//
<i>5</i>&nbsp;
<i>6</i>&nbsp;package com.sun.tools.internal.ws.processor.generator;
<i>7</i>&nbsp;
<i>8</i>&nbsp;import com.sun.codemodel.internal.ClassType;
<i>9</i>&nbsp;import com.sun.codemodel.internal.JAnnotationArrayMember;
<i>10</i>&nbsp;import com.sun.codemodel.internal.JAnnotationUse;
<i>11</i>&nbsp;import com.sun.codemodel.internal.JClass;
<i>12</i>&nbsp;import com.sun.codemodel.internal.JClassAlreadyExistsException;
<i>13</i>&nbsp;import com.sun.codemodel.internal.JCommentPart;
<i>14</i>&nbsp;import com.sun.codemodel.internal.JDefinedClass;
<i>15</i>&nbsp;import com.sun.codemodel.internal.JDocComment;
<i>16</i>&nbsp;import com.sun.codemodel.internal.JMethod;
<i>17</i>&nbsp;import com.sun.codemodel.internal.JPackage;
<i>18</i>&nbsp;import com.sun.codemodel.internal.JVar;
<i>19</i>&nbsp;import com.sun.tools.internal.ws.api.TJavaGeneratorExtension;
<i>20</i>&nbsp;import com.sun.tools.internal.ws.processor.generator.GeneratorBase;
<i>21</i>&nbsp;import com.sun.tools.internal.ws.processor.generator.GeneratorUtil;
<i>22</i>&nbsp;import com.sun.tools.internal.ws.processor.generator.JavaGeneratorExtensionFacade;
<i>23</i>&nbsp;import com.sun.tools.internal.ws.processor.generator.Names;
<i>24</i>&nbsp;import com.sun.tools.internal.ws.processor.generator.W3CAddressingJavaGeneratorExtension;
<i>25</i>&nbsp;import com.sun.tools.internal.ws.processor.model.AsyncOperation;
<i>26</i>&nbsp;import com.sun.tools.internal.ws.processor.model.Block;
<i>27</i>&nbsp;import com.sun.tools.internal.ws.processor.model.Fault;
<i>28</i>&nbsp;import com.sun.tools.internal.ws.processor.model.Message;
<i>29</i>&nbsp;import com.sun.tools.internal.ws.processor.model.Model;
<i>30</i>&nbsp;import com.sun.tools.internal.ws.processor.model.Operation;
<i>31</i>&nbsp;import com.sun.tools.internal.ws.processor.model.Parameter;
<i>32</i>&nbsp;import com.sun.tools.internal.ws.processor.model.Port;
<i>33</i>&nbsp;import com.sun.tools.internal.ws.processor.model.Request;
<i>34</i>&nbsp;import com.sun.tools.internal.ws.processor.model.Response;
<i>35</i>&nbsp;import com.sun.tools.internal.ws.processor.model.Service;
<i>36</i>&nbsp;import com.sun.tools.internal.ws.processor.model.java.JavaInterface;
<i>37</i>&nbsp;import com.sun.tools.internal.ws.processor.model.java.JavaMethod;
<i>38</i>&nbsp;import com.sun.tools.internal.ws.processor.model.java.JavaParameter;
<i>39</i>&nbsp;import com.sun.tools.internal.ws.processor.model.jaxb.JAXBType;
<i>40</i>&nbsp;import com.sun.tools.internal.ws.processor.model.jaxb.JAXBTypeAndAnnotation;
<i>41</i>&nbsp;import com.sun.tools.internal.ws.resources.GeneratorMessages;
<i>42</i>&nbsp;import com.sun.tools.internal.ws.wscompile.ErrorReceiver;
<i>43</i>&nbsp;import com.sun.tools.internal.ws.wscompile.WsimportOptions;
<i>44</i>&nbsp;import com.sun.tools.internal.ws.wscompile.Options.Target;
<i>45</i>&nbsp;import com.sun.tools.internal.ws.wsdl.document.PortType;
<i>46</i>&nbsp;import com.sun.tools.internal.ws.wsdl.document.soap.SOAPStyle;
<i>47</i>&nbsp;import java.util.ArrayList;
<i>48</i>&nbsp;import java.util.Iterator;
<i>49</i>&nbsp;import java.util.List;
<i>50</i>&nbsp;import javax.jws.Oneway;
<i>51</i>&nbsp;import javax.jws.WebMethod;
<i>52</i>&nbsp;import javax.jws.WebParam;
<i>53</i>&nbsp;import javax.jws.WebResult;
<i>54</i>&nbsp;import javax.jws.WebService;
<i>55</i>&nbsp;import javax.jws.WebParam.Mode;
<i>56</i>&nbsp;import javax.jws.soap.SOAPBinding;
<i>57</i>&nbsp;import javax.jws.soap.SOAPBinding.ParameterStyle;
<i>58</i>&nbsp;import javax.jws.soap.SOAPBinding.Style;
<i>59</i>&nbsp;import javax.xml.bind.annotation.XmlSeeAlso;
<i>60</i>&nbsp;import javax.xml.namespace.QName;
<i>61</i>&nbsp;import javax.xml.ws.Holder;
<i>62</i>&nbsp;import javax.xml.ws.RequestWrapper;
<b class="nc"><i>63</i>&nbsp;import javax.xml.ws.ResponseWrapper;</b>
<b class="nc"><i>64</i>&nbsp;import org.xml.sax.Locator;</b>
<i>65</i>&nbsp;
<i>66</i>&nbsp;public class SeiGenerator extends GeneratorBase {
<i>67</i>&nbsp;    private String serviceNS;
<b class="nc"><i>68</i>&nbsp;    private TJavaGeneratorExtension extension;</b>
<b class="nc"><i>69</i>&nbsp;    private List&lt;TJavaGeneratorExtension&gt; extensionHandlers = new ArrayList();</b>
<i>70</i>&nbsp;    private boolean isDocStyle = true;
<i>71</i>&nbsp;    private boolean sameParamStyle = true;
<i>72</i>&nbsp;
<i>73</i>&nbsp;    public static void generate(Model model, WsimportOptions options, ErrorReceiver receiver, TJavaGeneratorExtension... extensions) {
<i>74</i>&nbsp;        SeiGenerator seiGenerator = new SeiGenerator(model, options, receiver, extensions);
<i>75</i>&nbsp;        seiGenerator.doGeneration();
<b class="nc"><i>76</i>&nbsp;    }</b>
<b class="nc"><i>77</i>&nbsp;</b>
<i>78</i>&nbsp;    private SeiGenerator(Model model, WsimportOptions options, ErrorReceiver receiver, TJavaGeneratorExtension... extensions) {
<b class="nc"><i>79</i>&nbsp;        super(model, options, receiver);</b>
<i>80</i>&nbsp;        if(options.target.isLaterThan(Target.V2_2)) {
<i>81</i>&nbsp;            this.register(new W3CAddressingJavaGeneratorExtension());
<i>82</i>&nbsp;        }
<b class="nc"><i>83</i>&nbsp;</b>
<b class="nc"><i>84</i>&nbsp;        TJavaGeneratorExtension[] arr$ = extensions;</b>
<i>85</i>&nbsp;        int len$ = extensions.length;
<b class="nc"><i>86</i>&nbsp;</b>
<b class="nc"><i>87</i>&nbsp;        for(int i$ = 0; i$ &lt; len$; ++i$) {</b>
<i>88</i>&nbsp;            TJavaGeneratorExtension j = arr$[i$];
<i>89</i>&nbsp;            this.register(j);
<i>90</i>&nbsp;        }
<i>91</i>&nbsp;
<b class="nc"><i>92</i>&nbsp;        this.extension = new JavaGeneratorExtensionFacade((TJavaGeneratorExtension[])this.extensionHandlers.toArray(new TJavaGeneratorExtension[0]));</b>
<i>93</i>&nbsp;    }
<b class="nc"><i>94</i>&nbsp;</b>
<b class="nc"><i>95</i>&nbsp;    private void write(Port port) {</b>
<b class="nc"><i>96</i>&nbsp;        JavaInterface intf = port.getJavaInterface();</b>
<i>97</i>&nbsp;        String className = Names.customJavaTypeClassName(intf);
<i>98</i>&nbsp;        if(this.donotOverride &amp;&amp; GeneratorUtil.classExists(this.options, className)) {
<b class="nc"><i>99</i>&nbsp;            this.log(&quot;Class &quot; + className + &quot; exists. Not overriding.&quot;);</b>
<b class="nc"><i>100</i>&nbsp;        } else {</b>
<b class="nc"><i>101</i>&nbsp;            JDefinedClass cls = null;</b>
<b class="nc"><i>102</i>&nbsp;</b>
<b class="nc"><i>103</i>&nbsp;            try {</b>
<i>104</i>&nbsp;                cls = this.getClass(className, ClassType.INTERFACE);
<b class="nc"><i>105</i>&nbsp;            } catch (JClassAlreadyExistsException var20) {</b>
<i>106</i>&nbsp;                QName ptDoc = (QName)port.getProperty(&quot;com.sun.xml.internal.ws.processor.model.WSDLPortTypeName&quot;);
<b class="nc"><i>107</i>&nbsp;                Locator webServiceAnn = null;</b>
<i>108</i>&nbsp;                if(ptDoc != null) {
<i>109</i>&nbsp;                    PortType i$ = (PortType)port.portTypes.get(ptDoc);
<b class="nc"><i>110</i>&nbsp;                    if(i$ != null) {</b>
<i>111</i>&nbsp;                        webServiceAnn = i$.getLocator();
<i>112</i>&nbsp;                    }
<i>113</i>&nbsp;                }
<b class="nc"><i>114</i>&nbsp;</b>
<i>115</i>&nbsp;                this.receiver.error(webServiceAnn, GeneratorMessages.GENERATOR_SEI_CLASS_ALREADY_EXIST(intf.getName(), ptDoc));
<b class="nc"><i>116</i>&nbsp;                return;</b>
<b class="nc"><i>117</i>&nbsp;            }</b>
<b class="nc"><i>118</i>&nbsp;</b>
<b class="nc"><i>119</i>&nbsp;            if(cls.methods().isEmpty()) {</b>
<i>120</i>&nbsp;                JDocComment comment = cls.javadoc();
<i>121</i>&nbsp;                String ptDoc1 = intf.getJavaDoc();
<b class="nc"><i>122</i>&nbsp;                if(ptDoc1 != null) {</b>
<b class="nc"><i>123</i>&nbsp;                    comment.add(ptDoc1);</b>
<i>124</i>&nbsp;                    comment.add(&quot;\n\n&quot;);
<i>125</i>&nbsp;                }
<i>126</i>&nbsp;
<i>127</i>&nbsp;                Iterator webServiceAnn1 = this.getJAXWSClassComment().iterator();
<b class="nc"><i>128</i>&nbsp;</b>
<b class="nc"><i>129</i>&nbsp;                while(webServiceAnn1.hasNext()) {</b>
<i>130</i>&nbsp;                    String i$3 = (String)webServiceAnn1.next();
<i>131</i>&nbsp;                    comment.add(i$3);
<b class="nc"><i>132</i>&nbsp;                }</b>
<i>133</i>&nbsp;
<i>134</i>&nbsp;                JAnnotationUse webServiceAnn2 = cls.annotate(this.cm.ref(WebService.class));
<b class="nc"><i>135</i>&nbsp;                this.writeWebServiceAnnotation(port, webServiceAnn2);</b>
<i>136</i>&nbsp;                this.writeHandlerConfig(Names.customJavaTypeClassName(port.getJavaInterface()), cls, this.options);
<i>137</i>&nbsp;                this.writeSOAPBinding(port, cls);
<b class="nc"><i>138</i>&nbsp;                if(this.options.target.isLaterThan(Target.V2_1)) {</b>
<b class="nc"><i>139</i>&nbsp;                    this.writeXmlSeeAlso(cls);</b>
<i>140</i>&nbsp;                }
<b class="nc"><i>141</i>&nbsp;</b>
<b class="nc"><i>142</i>&nbsp;                Iterator i$2 = port.getOperations().iterator();</b>
<i>143</i>&nbsp;
<i>144</i>&nbsp;                while(i$2.hasNext()) {
<i>145</i>&nbsp;                    Operation operation = (Operation)i$2.next();
<i>146</i>&nbsp;                    JavaMethod method = operation.getJavaMethod();
<b class="nc"><i>147</i>&nbsp;                    String methodJavaDoc = operation.getJavaDoc();</b>
<b class="nc"><i>148</i>&nbsp;                    JMethod m;</b>
<b class="nc"><i>149</i>&nbsp;                    JDocComment methodDoc;</b>
<b class="nc"><i>150</i>&nbsp;                    if(method.getReturnType().getName().equals(&quot;void&quot;)) {</b>
<i>151</i>&nbsp;                        m = cls.method(1, Void.TYPE, method.getName());
<b class="nc"><i>152</i>&nbsp;                        methodDoc = m.javadoc();</b>
<b class="nc"><i>153</i>&nbsp;                    } else {</b>
<b class="nc"><i>154</i>&nbsp;                        JAXBTypeAndAnnotation holder = method.getReturnType().getType();</b>
<b class="nc"><i>155</i>&nbsp;                        m = cls.method(1, holder.getType(), method.getName());</b>
<b class="nc"><i>156</i>&nbsp;                        holder.annotate(m);</b>
<b class="nc"><i>157</i>&nbsp;                        methodDoc = m.javadoc();</b>
<i>158</i>&nbsp;                        JCommentPart wsdlOp = methodDoc.addReturn();
<b class="nc"><i>159</i>&nbsp;                        wsdlOp.add(&quot;returns &quot; + holder.getName());</b>
<b class="nc"><i>160</i>&nbsp;                    }</b>
<i>161</i>&nbsp;
<b class="nc"><i>162</i>&nbsp;                    if(methodJavaDoc != null) {</b>
<b class="nc"><i>163</i>&nbsp;                        methodDoc.add(methodJavaDoc);</b>
<b class="nc"><i>164</i>&nbsp;                    }</b>
<i>165</i>&nbsp;
<b class="nc"><i>166</i>&nbsp;                    this.writeWebMethod(operation, m);</b>
<b class="nc"><i>167</i>&nbsp;                    JClass holder1 = this.cm.ref(Holder.class);</b>
<b class="nc"><i>168</i>&nbsp;                    Iterator wsdlOp1 = method.getParametersList().iterator();</b>
<i>169</i>&nbsp;
<b class="nc"><i>170</i>&nbsp;                    while(wsdlOp1.hasNext()) {</b>
<i>171</i>&nbsp;                        JavaParameter i$1 = (JavaParameter)wsdlOp1.next();
<i>172</i>&nbsp;                        JAXBTypeAndAnnotation paramType = i$1.getType().getType();
<i>173</i>&nbsp;                        JVar fault;
<b class="nc"><i>174</i>&nbsp;                        if(i$1.isHolder()) {</b>
<b class="nc"><i>175</i>&nbsp;                            fault = m.param(holder1.narrow(paramType.getType().boxify()), i$1.getName());</b>
<b class="nc"><i>176</i>&nbsp;                        } else {</b>
<b class="nc"><i>177</i>&nbsp;                            fault = m.param(paramType.getType(), i$1.getName());</b>
<b class="nc"><i>178</i>&nbsp;                        }</b>
<b class="nc"><i>179</i>&nbsp;</b>
<b class="nc"><i>180</i>&nbsp;                        paramType.annotate(fault);</b>
<b class="nc"><i>181</i>&nbsp;                        methodDoc.addParam(fault);</b>
<b class="nc"><i>182</i>&nbsp;                        JAnnotationUse paramAnn = fault.annotate(this.cm.ref(WebParam.class));</b>
<b class="nc"><i>183</i>&nbsp;                        this.writeWebParam(operation, i$1, paramAnn);</b>
<i>184</i>&nbsp;                    }
<i>185</i>&nbsp;
<i>186</i>&nbsp;                    com.sun.tools.internal.ws.wsdl.document.Operation wsdlOp2 = operation.getWSDLPortTypeOperation();
<b class="nc"><i>187</i>&nbsp;                    Iterator i$4 = operation.getFaultsSet().iterator();</b>
<b class="nc"><i>188</i>&nbsp;</b>
<i>189</i>&nbsp;                    while(i$4.hasNext()) {
<i>190</i>&nbsp;                        Fault fault1 = (Fault)i$4.next();
<i>191</i>&nbsp;                        m._throws(fault1.getExceptionClass());
<b class="nc"><i>192</i>&nbsp;                        methodDoc.addThrows(fault1.getExceptionClass());</b>
<b class="nc"><i>193</i>&nbsp;                        wsdlOp2.putFault(fault1.getWsdlFaultName(), fault1.getExceptionClass());</b>
<i>194</i>&nbsp;                    }
<i>195</i>&nbsp;
<b class="nc"><i>196</i>&nbsp;                    this.extension.writeMethodAnnotations(wsdlOp2, m);</b>
<i>197</i>&nbsp;                }
<i>198</i>&nbsp;
<b class="nc"><i>199</i>&nbsp;            }</b>
<b class="nc"><i>200</i>&nbsp;        }</b>
<b class="nc"><i>201</i>&nbsp;    }</b>
<b class="nc"><i>202</i>&nbsp;</b>
<i>203</i>&nbsp;    private void writeXmlSeeAlso(JDefinedClass cls) {
<i>204</i>&nbsp;        if(this.model.getJAXBModel().getS2JJAXBModel() != null) {
<i>205</i>&nbsp;            List objectFactories = this.model.getJAXBModel().getS2JJAXBModel().getAllObjectFactories();
<i>206</i>&nbsp;            if(objectFactories.size() == 0) {
<i>207</i>&nbsp;                return;
<i>208</i>&nbsp;            }
<b class="nc"><i>209</i>&nbsp;</b>
<b class="nc"><i>210</i>&nbsp;            JAnnotationUse xmlSeeAlso = cls.annotate(this.cm.ref(XmlSeeAlso.class));</b>
<b class="nc"><i>211</i>&nbsp;            JAnnotationArrayMember paramArray = xmlSeeAlso.paramArray(&quot;value&quot;);</b>
<i>212</i>&nbsp;
<i>213</i>&nbsp;            JClass of;
<i>214</i>&nbsp;            for(Iterator i$ = objectFactories.iterator(); i$.hasNext(); paramArray = paramArray.param(of)) {
<b class="nc"><i>215</i>&nbsp;                of = (JClass)i$.next();</b>
<b class="nc"><i>216</i>&nbsp;            }</b>
<i>217</i>&nbsp;        }
<i>218</i>&nbsp;
<b class="nc"><i>219</i>&nbsp;    }</b>
<b class="nc"><i>220</i>&nbsp;</b>
<i>221</i>&nbsp;    private void writeWebMethod(Operation operation, JMethod m) {
<i>222</i>&nbsp;        Response response = operation.getResponse();
<b class="nc"><i>223</i>&nbsp;        JAnnotationUse webMethodAnn = m.annotate(this.cm.ref(WebMethod.class));</b>
<b class="nc"><i>224</i>&nbsp;        String operationName = operation instanceof AsyncOperation?((AsyncOperation)operation).getNormalOperation().getName().getLocalPart():operation.getName().getLocalPart();</b>
<b class="nc"><i>225</i>&nbsp;        if(!m.name().equals(operationName)) {</b>
<i>226</i>&nbsp;            webMethodAnn.param(&quot;operationName&quot;, operationName);
<i>227</i>&nbsp;        }
<b class="nc"><i>228</i>&nbsp;</b>
<b class="nc"><i>229</i>&nbsp;        if(operation.getSOAPAction() != null &amp;&amp; operation.getSOAPAction().length() &gt; 0) {</b>
<b class="nc"><i>230</i>&nbsp;            webMethodAnn.param(&quot;action&quot;, operation.getSOAPAction());</b>
<b class="nc"><i>231</i>&nbsp;        }</b>
<b class="nc"><i>232</i>&nbsp;</b>
<b class="nc"><i>233</i>&nbsp;        Block reqBlock;</b>
<b class="nc"><i>234</i>&nbsp;        if(operation.getResponse() == null) {</b>
<i>235</i>&nbsp;            m.annotate(Oneway.class);
<i>236</i>&nbsp;        } else if(!operation.getJavaMethod().getReturnType().getName().equals(&quot;void&quot;) &amp;&amp; operation.getResponse().getParametersList().size() &gt; 0) {
<i>237</i>&nbsp;            String reqW = null;
<b class="nc"><i>238</i>&nbsp;            String resW = null;</b>
<b class="nc"><i>239</i>&nbsp;            if(operation.getResponse().getBodyBlocks().hasNext()) {</b>
<b class="nc"><i>240</i>&nbsp;                reqBlock = (Block)operation.getResponse().getBodyBlocks().next();</b>
<b class="nc"><i>241</i>&nbsp;                reqW = reqBlock.getName().getLocalPart();</b>
<b class="nc"><i>242</i>&nbsp;                if(this.isDocStyle || reqBlock.getLocation() == 2) {</b>
<i>243</i>&nbsp;                    resW = reqBlock.getName().getNamespaceURI();
<b class="nc"><i>244</i>&nbsp;                }</b>
<i>245</i>&nbsp;            }
<b class="nc"><i>246</i>&nbsp;</b>
<b class="nc"><i>247</i>&nbsp;            Iterator resBlock = operation.getResponse().getParametersList().iterator();</b>
<i>248</i>&nbsp;
<b class="nc"><i>249</i>&nbsp;            while(resBlock.hasNext()) {</b>
<b class="nc"><i>250</i>&nbsp;                Parameter parameter = (Parameter)resBlock.next();</b>
<b class="nc"><i>251</i>&nbsp;                if(parameter.getParameterIndex() == -1) {</b>
<b class="nc"><i>252</i>&nbsp;                    if(!operation.isWrapped() &amp;&amp; this.isDocStyle) {</b>
<i>253</i>&nbsp;                        if(this.isDocStyle) {
<b class="nc"><i>254</i>&nbsp;                            JAXBType wr = (JAXBType)parameter.getType();</b>
<b class="nc"><i>255</i>&nbsp;                            reqW = wr.getName().getLocalPart();</b>
<i>256</i>&nbsp;                            resW = wr.getName().getNamespaceURI();
<b class="nc"><i>257</i>&nbsp;                        }</b>
<b class="nc"><i>258</i>&nbsp;                    } else {</b>
<b class="nc"><i>259</i>&nbsp;                        if(parameter.getBlock().getLocation() == 2) {</b>
<i>260</i>&nbsp;                            reqW = parameter.getBlock().getName().getLocalPart();
<b class="nc"><i>261</i>&nbsp;                        } else {</b>
<b class="nc"><i>262</i>&nbsp;                            reqW = parameter.getName();</b>
<b class="nc"><i>263</i>&nbsp;                        }</b>
<b class="nc"><i>264</i>&nbsp;</b>
<i>265</i>&nbsp;                        if(this.isDocStyle || parameter.getBlock().getLocation() == 2) {
<i>266</i>&nbsp;                            resW = parameter.getType().getName().getNamespaceURI();
<b class="nc"><i>267</i>&nbsp;                        }</b>
<i>268</i>&nbsp;                    }
<b class="nc"><i>269</i>&nbsp;</b>
<b class="nc"><i>270</i>&nbsp;                    if(!(operation instanceof AsyncOperation)) {</b>
<b class="nc"><i>271</i>&nbsp;                        JAnnotationUse wr1 = null;</b>
<i>272</i>&nbsp;                        if(!reqW.equals(&quot;return&quot;)) {
<b class="nc"><i>273</i>&nbsp;                            wr1 = m.annotate(WebResult.class);</b>
<b class="nc"><i>274</i>&nbsp;                            wr1.param(&quot;name&quot;, reqW);</b>
<b class="nc"><i>275</i>&nbsp;                        }</b>
<b class="nc"><i>276</i>&nbsp;</b>
<i>277</i>&nbsp;                        if(resW != null &amp;&amp; (!resW.equals(this.serviceNS) || this.isDocStyle &amp;&amp; operation.isWrapped())) {
<b class="nc"><i>278</i>&nbsp;                            if(wr1 == null) {</b>
<i>279</i>&nbsp;                                wr1 = m.annotate(WebResult.class);
<i>280</i>&nbsp;                            }
<i>281</i>&nbsp;
<i>282</i>&nbsp;                            wr1.param(&quot;targetNamespace&quot;, resW);
<i>283</i>&nbsp;                        }
<i>284</i>&nbsp;
<b class="nc"><i>285</i>&nbsp;                        if(!this.isDocStyle || !operation.isWrapped() || parameter.getBlock().getLocation() == 2) {</b>
<b class="nc"><i>286</i>&nbsp;                            if(wr1 == null) {</b>
<b class="nc"><i>287</i>&nbsp;                                wr1 = m.annotate(WebResult.class);</b>
<b class="nc"><i>288</i>&nbsp;                            }</b>
<i>289</i>&nbsp;
<i>290</i>&nbsp;                            wr1.param(&quot;partName&quot;, parameter.getName());
<i>291</i>&nbsp;                        }
<b class="nc"><i>292</i>&nbsp;</b>
<b class="nc"><i>293</i>&nbsp;                        if(parameter.getBlock().getLocation() == 2) {</b>
<b class="nc"><i>294</i>&nbsp;                            if(wr1 == null) {</b>
<b class="nc"><i>295</i>&nbsp;                                wr1 = m.annotate(WebResult.class);</b>
<b class="nc"><i>296</i>&nbsp;                            }</b>
<b class="nc"><i>297</i>&nbsp;</b>
<i>298</i>&nbsp;                            wr1.param(&quot;header&quot;, true);
<b class="nc"><i>299</i>&nbsp;                        }</b>
<b class="nc"><i>300</i>&nbsp;                    }</b>
<b class="nc"><i>301</i>&nbsp;                }</b>
<b class="nc"><i>302</i>&nbsp;            }</b>
<b class="nc"><i>303</i>&nbsp;        }</b>
<b class="nc"><i>304</i>&nbsp;</b>
<i>305</i>&nbsp;        if(!this.sameParamStyle &amp;&amp; !operation.isWrapped()) {
<i>306</i>&nbsp;            JAnnotationUse reqBlock1 = m.annotate(SOAPBinding.class);
<i>307</i>&nbsp;            reqBlock1.param(&quot;parameterStyle&quot;, ParameterStyle.BARE);
<i>308</i>&nbsp;        }
<i>309</i>&nbsp;
<b class="nc"><i>310</i>&nbsp;        if(operation.isWrapped() &amp;&amp; operation.getStyle().equals(SOAPStyle.DOCUMENT)) {</b>
<i>311</i>&nbsp;            reqBlock = (Block)operation.getRequest().getBodyBlocks().next();
<b class="nc"><i>312</i>&nbsp;            JAnnotationUse reqW1 = m.annotate(RequestWrapper.class);</b>
<i>313</i>&nbsp;            reqW1.param(&quot;localName&quot;, reqBlock.getName().getLocalPart());
<i>314</i>&nbsp;            reqW1.param(&quot;targetNamespace&quot;, reqBlock.getName().getNamespaceURI());
<i>315</i>&nbsp;            reqW1.param(&quot;className&quot;, reqBlock.getType().getJavaType().getName());
<i>316</i>&nbsp;            if(response != null) {
<i>317</i>&nbsp;                JAnnotationUse resW1 = m.annotate(ResponseWrapper.class);
<b class="nc"><i>318</i>&nbsp;                Block resBlock1 = (Block)response.getBodyBlocks().next();</b>
<b class="nc"><i>319</i>&nbsp;                resW1.param(&quot;localName&quot;, resBlock1.getName().getLocalPart());</b>
<i>320</i>&nbsp;                resW1.param(&quot;targetNamespace&quot;, resBlock1.getName().getNamespaceURI());
<b class="nc"><i>321</i>&nbsp;                resW1.param(&quot;className&quot;, resBlock1.getType().getJavaType().getName());</b>
<b class="nc"><i>322</i>&nbsp;            }</b>
<b class="nc"><i>323</i>&nbsp;        }</b>
<i>324</i>&nbsp;
<b class="nc"><i>325</i>&nbsp;    }</b>
<i>326</i>&nbsp;
<i>327</i>&nbsp;    private boolean isMessageParam(Parameter param, Message message) {
<i>328</i>&nbsp;        Block block = param.getBlock();
<b class="nc"><i>329</i>&nbsp;        return message.getBodyBlockCount() &gt; 0 &amp;&amp; block.equals(message.getBodyBlocks().next()) || message.getHeaderBlockCount() &gt; 0 &amp;&amp; block.equals(message.getHeaderBlocks().next());</b>
<b class="nc"><i>330</i>&nbsp;    }</b>
<i>331</i>&nbsp;
<b class="nc"><i>332</i>&nbsp;    private boolean isHeaderParam(Parameter param, Message message) {</b>
<b class="nc"><i>333</i>&nbsp;        if(message.getHeaderBlockCount() == 0) {</b>
<b class="nc"><i>334</i>&nbsp;            return false;</b>
<i>335</i>&nbsp;        } else {
<b class="nc"><i>336</i>&nbsp;            Iterator i$ = message.getHeaderBlocksMap().values().iterator();</b>
<i>337</i>&nbsp;
<i>338</i>&nbsp;            Block headerBlock;
<i>339</i>&nbsp;            do {
<b class="nc"><i>340</i>&nbsp;                if(!i$.hasNext()) {</b>
<b class="nc"><i>341</i>&nbsp;                    return false;</b>
<i>342</i>&nbsp;                }
<b class="nc"><i>343</i>&nbsp;</b>
<b class="nc"><i>344</i>&nbsp;                headerBlock = (Block)i$.next();</b>
<b class="nc"><i>345</i>&nbsp;            } while(!param.getBlock().equals(headerBlock));</b>
<i>346</i>&nbsp;
<b class="nc"><i>347</i>&nbsp;            return true;</b>
<i>348</i>&nbsp;        }
<i>349</i>&nbsp;    }
<i>350</i>&nbsp;
<b class="nc"><i>351</i>&nbsp;    private boolean isAttachmentParam(Parameter param, Message message) {</b>
<b class="nc"><i>352</i>&nbsp;        if(message.getAttachmentBlockCount() == 0) {</b>
<b class="nc"><i>353</i>&nbsp;            return false;</b>
<i>354</i>&nbsp;        } else {
<b class="nc"><i>355</i>&nbsp;            Iterator i$ = message.getAttachmentBlocksMap().values().iterator();</b>
<i>356</i>&nbsp;
<i>357</i>&nbsp;            Block attBlock;
<i>358</i>&nbsp;            do {
<b class="nc"><i>359</i>&nbsp;                if(!i$.hasNext()) {</b>
<i>360</i>&nbsp;                    return false;
<b class="nc"><i>361</i>&nbsp;                }</b>
<b class="nc"><i>362</i>&nbsp;</b>
<i>363</i>&nbsp;                attBlock = (Block)i$.next();
<b class="nc"><i>364</i>&nbsp;            } while(!param.getBlock().equals(attBlock));</b>
<i>365</i>&nbsp;
<b class="nc"><i>366</i>&nbsp;            return true;</b>
<i>367</i>&nbsp;        }
<b class="nc"><i>368</i>&nbsp;    }</b>
<i>369</i>&nbsp;
<b class="nc"><i>370</i>&nbsp;    private boolean isUnboundParam(Parameter param, Message message) {</b>
<b class="nc"><i>371</i>&nbsp;        if(message.getUnboundBlocksCount() == 0) {</b>
<b class="nc"><i>372</i>&nbsp;            return false;</b>
<b class="nc"><i>373</i>&nbsp;        } else {</b>
<i>374</i>&nbsp;            Iterator i$ = message.getUnboundBlocksMap().values().iterator();
<b class="nc"><i>375</i>&nbsp;</b>
<b class="nc"><i>376</i>&nbsp;            Block unboundBlock;</b>
<i>377</i>&nbsp;            do {
<i>378</i>&nbsp;                if(!i$.hasNext()) {
<b class="nc"><i>379</i>&nbsp;                    return false;</b>
<b class="nc"><i>380</i>&nbsp;                }</b>
<i>381</i>&nbsp;
<b class="nc"><i>382</i>&nbsp;                unboundBlock = (Block)i$.next();</b>
<b class="nc"><i>383</i>&nbsp;            } while(!param.getBlock().equals(unboundBlock));</b>
<i>384</i>&nbsp;
<i>385</i>&nbsp;            return true;
<b class="nc"><i>386</i>&nbsp;        }</b>
<b class="nc"><i>387</i>&nbsp;    }</b>
<b class="nc"><i>388</i>&nbsp;</b>
<i>389</i>&nbsp;    private void writeWebParam(Operation operation, JavaParameter javaParameter, JAnnotationUse paramAnno) {
<b class="nc"><i>390</i>&nbsp;        Parameter param = javaParameter.getParameter();</b>
<i>391</i>&nbsp;        Request req = operation.getRequest();
<i>392</i>&nbsp;        Response res = operation.getResponse();
<i>393</i>&nbsp;        boolean header = this.isHeaderParam(param, req) || res != null &amp;&amp; this.isHeaderParam(param, res);
<b class="nc"><i>394</i>&nbsp;        boolean isWrapped = operation.isWrapped();</b>
<b class="nc"><i>395</i>&nbsp;        String name;</b>
<i>396</i>&nbsp;        if(param.getBlock().getLocation() != 2 &amp;&amp; (!this.isDocStyle || isWrapped)) {
<i>397</i>&nbsp;            name = param.getName();
<b class="nc"><i>398</i>&nbsp;        } else {</b>
<b class="nc"><i>399</i>&nbsp;            name = param.getBlock().getName().getLocalPart();</b>
<i>400</i>&nbsp;        }
<b class="nc"><i>401</i>&nbsp;</b>
<b class="nc"><i>402</i>&nbsp;        paramAnno.param(&quot;name&quot;, name);</b>
<b class="nc"><i>403</i>&nbsp;        String ns = null;</b>
<b class="nc"><i>404</i>&nbsp;        if(this.isDocStyle) {</b>
<b class="nc"><i>405</i>&nbsp;            ns = param.getBlock().getName().getNamespaceURI();</b>
<b class="nc"><i>406</i>&nbsp;            if(isWrapped) {</b>
<i>407</i>&nbsp;                ns = param.getType().getName().getNamespaceURI();
<b class="nc"><i>408</i>&nbsp;            }</b>
<b class="nc"><i>409</i>&nbsp;        } else if(header) {</b>
<b class="nc"><i>410</i>&nbsp;            ns = param.getBlock().getName().getNamespaceURI();</b>
<b class="nc"><i>411</i>&nbsp;        }</b>
<b class="nc"><i>412</i>&nbsp;</b>
<b class="nc"><i>413</i>&nbsp;        if(ns != null &amp;&amp; (!ns.equals(this.serviceNS) || this.isDocStyle &amp;&amp; isWrapped)) {</b>
<b class="nc"><i>414</i>&nbsp;            paramAnno.param(&quot;targetNamespace&quot;, ns);</b>
<b class="nc"><i>415</i>&nbsp;        }</b>
<i>416</i>&nbsp;
<b class="nc"><i>417</i>&nbsp;        if(header) {</b>
<b class="nc"><i>418</i>&nbsp;            paramAnno.param(&quot;header&quot;, true);</b>
<b class="nc"><i>419</i>&nbsp;        }</b>
<i>420</i>&nbsp;
<b class="nc"><i>421</i>&nbsp;        if(param.isINOUT()) {</b>
<b class="nc"><i>422</i>&nbsp;            paramAnno.param(&quot;mode&quot;, Mode.INOUT);</b>
<i>423</i>&nbsp;        } else if(res != null &amp;&amp; (this.isMessageParam(param, res) || this.isHeaderParam(param, res) || this.isAttachmentParam(param, res) || this.isUnboundParam(param, res) || param.isOUT())) {
<b class="nc"><i>424</i>&nbsp;            paramAnno.param(&quot;mode&quot;, Mode.OUT);</b>
<b class="nc"><i>425</i>&nbsp;        }</b>
<b class="nc"><i>426</i>&nbsp;</b>
<b class="nc"><i>427</i>&nbsp;        if(!this.isDocStyle || !isWrapped || header) {</b>
<i>428</i>&nbsp;            paramAnno.param(&quot;partName&quot;, javaParameter.getParameter().getName());
<i>429</i>&nbsp;        }
<i>430</i>&nbsp;
<i>431</i>&nbsp;    }
<b class="nc"><i>432</i>&nbsp;</b>
<b class="nc"><i>433</i>&nbsp;    private void writeSOAPBinding(Port port, JDefinedClass cls) {</b>
<b class="nc"><i>434</i>&nbsp;        JAnnotationUse soapBindingAnn = null;</b>
<i>435</i>&nbsp;        this.isDocStyle = port.getStyle() == null || port.getStyle().equals(SOAPStyle.DOCUMENT);
<i>436</i>&nbsp;        if(!this.isDocStyle) {
<i>437</i>&nbsp;            soapBindingAnn = cls.annotate(SOAPBinding.class);
<i>438</i>&nbsp;            soapBindingAnn.param(&quot;style&quot;, Style.RPC);
<i>439</i>&nbsp;            port.setWrapped(true);
<i>440</i>&nbsp;        }
<b class="nc"><i>441</i>&nbsp;</b>
<b class="nc"><i>442</i>&nbsp;        if(this.isDocStyle) {</b>
<i>443</i>&nbsp;            boolean first = true;
<i>444</i>&nbsp;            boolean isWrapper = true;
<i>445</i>&nbsp;            Iterator i$ = port.getOperations().iterator();
<i>446</i>&nbsp;
<b class="nc"><i>447</i>&nbsp;            while(i$.hasNext()) {</b>
<b class="nc"><i>448</i>&nbsp;                Operation operation = (Operation)i$.next();</b>
<b class="nc"><i>449</i>&nbsp;                if(first) {</b>
<b class="nc"><i>450</i>&nbsp;                    isWrapper = operation.isWrapped();</b>
<i>451</i>&nbsp;                    first = false;
<i>452</i>&nbsp;                } else {
<b class="nc"><i>453</i>&nbsp;                    this.sameParamStyle = isWrapper == operation.isWrapped();</b>
<b class="nc"><i>454</i>&nbsp;                    if(!this.sameParamStyle) {</b>
<i>455</i>&nbsp;                        break;
<i>456</i>&nbsp;                    }
<i>457</i>&nbsp;                }
<i>458</i>&nbsp;            }
<b class="nc"><i>459</i>&nbsp;</b>
<i>460</i>&nbsp;            if(this.sameParamStyle) {
<i>461</i>&nbsp;                port.setWrapped(isWrapper);
<b class="nc"><i>462</i>&nbsp;            }</b>
<i>463</i>&nbsp;        }
<i>464</i>&nbsp;
<i>465</i>&nbsp;        if(this.sameParamStyle &amp;&amp; !port.isWrapped()) {
<b class="nc"><i>466</i>&nbsp;            if(soapBindingAnn == null) {</b>
<i>467</i>&nbsp;                soapBindingAnn = cls.annotate(SOAPBinding.class);
<i>468</i>&nbsp;            }
<i>469</i>&nbsp;
<i>470</i>&nbsp;            soapBindingAnn.param(&quot;parameterStyle&quot;, ParameterStyle.BARE);
<i>471</i>&nbsp;        }
<i>472</i>&nbsp;
<i>473</i>&nbsp;    }
<i>474</i>&nbsp;
<i>475</i>&nbsp;    private void writeWebServiceAnnotation(Port port, JAnnotationUse wsa) {
<i>476</i>&nbsp;        QName name = (QName)port.getProperty(&quot;com.sun.xml.internal.ws.processor.model.WSDLPortTypeName&quot;);
<i>477</i>&nbsp;        wsa.param(&quot;name&quot;, name.getLocalPart());
<i>478</i>&nbsp;        wsa.param(&quot;targetNamespace&quot;, name.getNamespaceURI());
<i>479</i>&nbsp;    }
<i>480</i>&nbsp;
<i>481</i>&nbsp;    public void visit(Model model) throws Exception {
<i>482</i>&nbsp;        Iterator i$ = model.getServices().iterator();
<i>483</i>&nbsp;
<i>484</i>&nbsp;        while(i$.hasNext()) {
<i>485</i>&nbsp;            Service s = (Service)i$.next();
<i>486</i>&nbsp;            s.accept(this);
<i>487</i>&nbsp;        }
<i>488</i>&nbsp;
<i>489</i>&nbsp;    }
<i>490</i>&nbsp;
<i>491</i>&nbsp;    public void visit(Service service) throws Exception {
<i>492</i>&nbsp;        String jd = this.model.getJavaDoc();
<i>493</i>&nbsp;        if(jd != null) {
<i>494</i>&nbsp;            JPackage i$ = this.cm._package(this.options.defaultPackage);
<i>495</i>&nbsp;            i$.javadoc().add(jd);
<i>496</i>&nbsp;        }
<i>497</i>&nbsp;
<i>498</i>&nbsp;        Iterator i$1 = service.getPorts().iterator();
<i>499</i>&nbsp;
<i>500</i>&nbsp;        while(i$1.hasNext()) {
<i>501</i>&nbsp;            Port p = (Port)i$1.next();
<i>502</i>&nbsp;            this.visitPort(service, p);
<i>503</i>&nbsp;        }
<i>504</i>&nbsp;
<i>505</i>&nbsp;    }
<i>506</i>&nbsp;
<i>507</i>&nbsp;    private void visitPort(Service service, Port port) {
<i>508</i>&nbsp;        if(!port.isProvider()) {
<i>509</i>&nbsp;            this.write(port);
<i>510</i>&nbsp;        }
<i>511</i>&nbsp;    }
<i>512</i>&nbsp;
<i>513</i>&nbsp;    private void register(TJavaGeneratorExtension h) {
<i>514</i>&nbsp;        this.extensionHandlers.add(h);
<i>515</i>&nbsp;    }
<i>516</i>&nbsp;}
</div>
</div>

<div class="footer">
    
    <div style="float:right;">generated on 2014-12-21 15:50</div>
</div>
</body>
</html>
